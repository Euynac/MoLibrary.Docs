# 待办事项

## 模型验证
[ASP.NET Core MVC 中的模型验证 | Microsoft Learn](https://learn.microsoft.com/zh-cn/aspnet/core/mvc/models/validation?view=aspnetcore-8.0)




## 测试

测试属性用户，此账号下所有操作犹如开启Debug模式，可看到错误堆栈等。
生产模式下，不会展示堆栈，但提供`traceId`


## 模块功能

### 运行时动态改变某个模块日志等级用于调试指定模块下功能


## 模块UI

### 自定义路由
ui 注册时，可以自定义路由，自定义路由实现是加入到路由字典，当 key 存在时，替换为 page 指定路径，page 路径根据静态字段维护，注册时可以获取对应映射关系

默认 page 路径规则改变为：
`/module/modulename/ui/feature name`

方案1：重定向中间件（推荐）

```cs
  // 创建路由重定向中间件
  public class UIRouteRedirectMiddleware(RequestDelegate next, IUIRouteConfigurationProvider routeProvider)
  {
      public async Task InvokeAsync(HttpContext context)
      {
          var path = context.Request.Path.Value;

          // 检查是否有路由映射
          foreach (var config in routeProvider.GetAllConfigurations())
          {
              if (path == config.CustomRoute)
              {
                  // 重定向到实际的组件路由
                  context.Request.Path = config.DefaultRoute;
                  break;
              }
          }

          await next(context);
      }
  }

```


修复路由问题：由于调整Configuration依赖Controller导致Controller模块提前初始化，导致后续执行的路由未能成功注册
增加这种检测机制？如果依赖的模块未能成功调用DependsOn说明有问题。


## nuget离线下载小工具

配置目录
识别所有.csproj文件然后勾选需要下载的。





## 配置管理


 配置管理界面的确认修改界面需要优化。 @SaveConfirmationDialog.razor 
 1. 

  相关界面代码：@d:\Euynac\Programming\.NET\Euynac\MoLibrary\MoLibrary.Configuration.Dashboard\Pages\
  @d:\Euynac\Programming\.NET\Euynac\MoLibrary\MoLibrary.Configuration.Dashboard\UIConfiguration

  设计文档详见：@d:\Euynac\Programming\.NET\Euynac\MoLibrary.Docs\docs\Configuration\MoConfigurationDashboard.md
  注意查看新的MudBlazor迁移文档


配置管理界面的 @ConfigurationEditor.razor 需要优化：
1. 除了复合类型的配置项，其余类型的配置项（SpecialType = None），都支持使用Inline Edit的方式编辑。对于复杂的使用编辑按钮。
2. 





## Chart

目前，我们项目用K8S部署，但是还是分别用yaml文件管理的我们业务微服务，非常混乱，我们需要统一管理，因此考虑采用Helm Chart的方式去统一管理所有服务。

请你根据我们目前的yaml文件生成chart管理文件。我们需求：
1. 可以自定义命名空间，比如我们的系统需要部署在多个地方，每个地方的命名空间是不同的，比如zggg-fips-dev，或zhhh-fips-dev。然后生产的是zggg-fips-prod，所以需要自定义命名空间。
2. 自定义业务微服务appid的前缀，比如可以设定为 `zggg-dev`，或`zggg-uat`。
3. 我们微服务采用的dapr的微服务框架，yaml工作负载命名和dapr appid一致。我们的微服务appid参考 @global-appsettings.json，将当前yaml的微服务appid都同步成这个配置下的。
4. 我们想要可以批量添加配置到业务微服务yaml文件，比如统一的环境变量、挂载、资源限制、dapr边车相关配置等等。


注意，我们是Helm Chart的新手，所以你除了要写详细的注释外，还需要完成详细的介绍文档，以及使用文档，最好还要详细讲解Chart目录结构，是如何工作的。

相关文件路径：@scripts/k8s，其中services是我们业务微服务文件夹，other-components是依赖的某些第三方组件服务。




## 文件、文本公网传输工具

现在需求是开发一个轻量的公网文件、文本传输工具，因为现在有很多局域网的传输工具比如LocalSend，但有些情况又需要不同网络之间传输，现在没有什么好用的工具。所以需要开发一个。

[kern/filepizza: :pizza: Peer-to-peer file transfers in your browser](https://github.com/kern/filepizza/)
[schlagmichdoch/PairDrop: PairDrop: Transfer Files Cross-Platform. No Setup, No Signup.](https://github.com/schlagmichdoch/PairDrop)

技术难题：
WebRTC P2P方案（最高效）
  - 只需信令服务器交换连接信息
  - 数据直接在A、B间传输，不经过服务器
  - 核心技术：WebRTC DataChannel + STUN/TURN
不要把文件上传的到公网再下载下来，非常占用资源。
另外程序需要一个美观的界面：
1. 设置快捷键，开启监听剪切板内容，只需要两边打开此程序，可以快速在一台电脑复制、另一台粘贴。支持包括文件、文字等。支持多选复制。
2. 文件大小需要设置阈值，数量限制，超过需要人工确认复制和粘贴。
3. 传输过程中需要有进度条，展示当前文件传输进度、数量、预估时间、速度等。
4. 能够设置中心节点地址。
5. 所以可能需要一个Server端，其他是Client端。Server端支持Docker镜像部署。
6. 界面能看到当前在线的Client。
7. Server需要生成Token，Client填写Token，Server验证，才能变成有效Client，相同Token视作同一组可进行相互传输。
8. 支持开机自启动。

以优秀开源项目方式