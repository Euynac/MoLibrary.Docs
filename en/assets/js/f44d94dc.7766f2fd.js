"use strict";(self.webpackChunkmy_docs=self.webpackChunkmy_docs||[]).push([[3025],{8453:(e,s,n)=>{n.d(s,{R:()=>a,x:()=>i});var r=n(6540);const t={},o=r.createContext(t);function a(e){const s=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),r.createElement(o.Provider,{value:s},e.children)}},9361:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>i,default:()=>p,frontMatter:()=>a,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"Tool/\u7edf\u4e00\u8fd4\u56de\u6a21\u578bRes","title":"Res<T>\u6cdb\u578b\u7c7b\u578b\u4ecb\u7ecd","description":"\u8981\u5feb\u901f\u8fd4\u56de\u9519\u8bef\u54cd\u5e94\uff0c\u8bf7\u4f7f\u7528\u4ee5\u4e0b\u6a21\u5f0f\uff1a","source":"@site/docs/Tool/\u7edf\u4e00\u8fd4\u56de\u6a21\u578bRes.md","sourceDirName":"Tool","slug":"/Tool/\u7edf\u4e00\u8fd4\u56de\u6a21\u578bRes","permalink":"/MoLibrary.Docs/en/docs/Tool/\u7edf\u4e00\u8fd4\u56de\u6a21\u578bRes","draft":false,"unlisted":false,"editUrl":"https://github.com/Euynac/MoLibrary/tree/main/docs/docs/Tool/\u7edf\u4e00\u8fd4\u56de\u6a21\u578bRes.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"MoSignalR","permalink":"/MoLibrary.Docs/en/docs/SignalR/MoSignalR"},"next":{"title":"\u5f85\u529e\u4e8b\u9879","permalink":"/MoLibrary.Docs/en/docs/\u5f85\u529e\u4e8b\u9879"}}');var t=n(4848),o=n(8453);const a={},i="Res<T>\u6cdb\u578b\u7c7b\u578b\u4ecb\u7ecd",c={},l=[{value:"<code>Res&lt;T&gt;</code>\u7684\u57fa\u672c\u5b9a\u4e49",id:"rest\u7684\u57fa\u672c\u5b9a\u4e49",level:2}];function d(e){const s={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsxs)(s.h1,{id:"rest\u6cdb\u578b\u7c7b\u578b\u4ecb\u7ecd",children:[(0,t.jsx)(s.code,{children:"Res<T>"}),"\u6cdb\u578b\u7c7b\u578b\u4ecb\u7ecd"]})}),"\n",(0,t.jsx)(s.p,{children:"\u8981\u5feb\u901f\u8fd4\u56de\u9519\u8bef\u54cd\u5e94\uff0c\u8bf7\u4f7f\u7528\u4ee5\u4e0b\u6a21\u5f0f\uff1a"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-csharp",children:'public override async Task<Res<ResponseUserCheck>> Handle(QueryUserCheck request,\n    CancellationToken cancellationToken)\n{\n    var userInfo = await repo.GetUserInfo(request.Username);\n    if (userInfo == null)\n    {\n        return $"\u7528\u6237\u540d{request.Username}\u4e0d\u5b58\u5728";\n    }\n    return _mapper.Map<ResponseUserCheck>(userInfo);\n}\n'})}),"\n",(0,t.jsx)(s.p,{children:"\u8981\u5728\u8c03\u7528\u8fd4\u56deRes\u7c7b\u578b\u7684\u65b9\u6cd5\u540e\u5feb\u901f\u83b7\u53d6\u9519\u8bef\uff0c\u8bf7\u4f7f\u7528\u4ee5\u4e0b\u6a21\u5f0f\uff1a"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-csharp",children:"if ((await userManger.FillUserInfo(user)).IsFailed(out error)) return error;\n"})}),"\n",(0,t.jsxs)(s.h2,{id:"rest\u7684\u57fa\u672c\u5b9a\u4e49",children:[(0,t.jsx)(s.code,{children:"Res<T>"}),"\u7684\u57fa\u672c\u5b9a\u4e49"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-csharp",children:'public record Res<T> : IServiceResponse\n{\n    public string? Message { get; set; }\n    public ResponseCode? Code { get; set; }\n    public T? Data { get; set; }\n\n    public Res() { Message = ""; }\n    public Res(T data) { Data = data; Code = ResponseCode.Ok; }\n    public Res(string message, ResponseCode code) { Message = message; Code = code; }\n    public Res(Exception e) { Message = $"\u670d\u52a1\u51fa\u73b0\u5f02\u5e38\uff1a{e}"; Code = ResponseCode.InternalError; }\n\n    public static implicit operator Res<T>(string res) => new(res, ResponseCode.BadRequest);\n    public static implicit operator Res<T>(T data) => new(data);\n    public static implicit operator string(Res<T> res) => res.Message ?? "";\n}\n\npublic record Res : IServiceResponse\n{\n    public string? Message { get; set; }\n    public ResponseCode? Code { get; set; }\n\n    public Res(string message, ResponseCode code) { Message = message; Code = code; }\n\n    public static Res Ok(string? hint = null) => new Res(hint ?? "", ResponseCode.Ok);\n    public static Res Ok([StringSyntax("CompositeFormat")] string format, params object?[] args) => new Res(string.Format(format, args), ResponseCode.Ok);\n    public static Res Fail(ResponseCode code, [StringSyntax("CompositeFormat")] string format, params object?[] args) => new Res(string.Format(format, args), code);\n    public static Res Fail(string failDesc, ResponseCode code = ResponseCode.BadRequest) => new Res(failDesc, code);\n    public static Res<T> Ok<T>(T data) => new Res<T>(data);\n    public static Res<T> Create<T>(T data, ResponseCode code) => new Res<T>(data) { Code = code };\n}\n\npublic static class ServiceResponseHelper\n{\n    public static bool IsOk(this IServiceResponse res) => res.Code == ResponseCode.Ok;\n    public static bool IsFailed<T>(this Res<T> res, [NotNullWhen(true)] out Res? error, [NotNullWhen(false)] out T? data)\n    {\n        error = null;\n        if (res.IsOk(out data)) return false;\n        error = res.Message;\n        return true;\n    }\n      public static bool IsFailed<T>(this Res<T> res, [NotNullWhen(true)] out Res? error)\n    {\n        error = null;\n        if (res.IsOk()) return false;\n        error = res.Message;\n        return true;\n    }\n}\n'})})]})}function p(e={}){const{wrapper:s}={...(0,o.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}}}]);